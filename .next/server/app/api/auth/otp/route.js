(()=>{var e={};e.id=791,e.ids=[791],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},39512:e=>{"use strict";e.exports=require("timers")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},39235:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>S,requestAsyncStorage:()=>v,routeModule:()=>x,serverHooks:()=>f,staticGenerationAsyncStorage:()=>q});var s={};r.r(s),r.d(s,{POST:()=>A});var i=r(49303),o=r(88716),n=r(60670),c=r(87070),a=r(92848),u=r(10109),p=r(1843);let d={getById:async function(e){try{let t=`select * from users where userid = '${e}'`,[r]=await p.Z.promise().query(t);return r}catch(e){return{error:e}}}};var l=r(71615);async function A(e,t){let r=(await e.json()).data,s=l.cookies().get("session")?.value,i=await d.getById(s),o=a.Z.decrypt(r);if(i.length>0){var n=await u.Z.validateOTP(o.otp,i[0].mobile);return(console.log(n),"approved"==n)?c.NextResponse.json({message:"ok"}):c.NextResponse.json({message:"error"})}}let x=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/otp/route",pathname:"/api/auth/otp",filename:"route",bundlePath:"app/api/auth/otp/route"},resolvedPagePath:"/Applications/MAMP/htdocs/projects/chip/brainstation-usermanagement/usermanagement/src/app/api/auth/otp/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:q,serverHooks:f}=x,g="/api/auth/otp/route";function S(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:q})}},1843:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var s=r(51648),i=r(57147),o=r.n(i);let n=s.createConnection({host:process.env.MYSQL_HOST,database:process.env.MYSQL_DB,user:process.env.MYSQL_USER,password:process.env.MYSQL_PASS,port:3306,connectTimeout:3e4,ssl:{ca:o().readFileSync("/Applications/MAMP/htdocs/Learning/Nextjs/authentication/authentication/src/app/db/DigiCertGlobalRootCA.crt.pem")}});n.connect(e=>{e?console.error("Database connection error"):console.log("Database connected!")});let c=n},10109:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(5558),i=r.n(s);let o={sendOTP:async function(e){let t=process.env.TWILIO_ACCOUNT_SID,r=process.env.TWILIO_AUTH_TOKEN;i()(t,r).verify.v2.services("VAe555aa2b839549085e979cffd98d9efd").verifications.create({channel:"sms",to:e})},validateOTP:async function(e,t){let r=process.env.TWILIO_ACCOUNT_SID,s=process.env.TWILIO_AUTH_TOKEN,o=i()(r,s);return(await o.verify.v2.services("VAe555aa2b839549085e979cffd98d9efd").verificationChecks.create({code:e,to:t})).status}}},92848:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(78625);let i={publicKey:`-----BEGIN PUBLIC KEY-----
  MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtyOurbfmmb3rDRkMtzS5M12WJ6pwrstlAnLb6MnYnQh8TgqVo7P/aTo+vmp0mZOlJWKSk2bHEjzr7btv3/UFYwkAwfwHlkH1WuX24lS2xbA7f+SsWt8qq74tMoPtiGgCbFCnR3TP5aJwWKfl8yGtz1Vf5+e03I3fJ5K3Ufj1l+VAo+DCjoPFj5S9qNE7f6A53O1ASEJvQ7olNtyUudMnvuUM8SGhKkOjdUqIXSBndQ7rVJsDS91oDz+LpHPOOkkIlt66Y3Co4VMSZZM5LHHt62lnKYK9r6DXYwjGQ8SM5AnhqXlImB1ZSKsXTMch04P93PR7GgFXhT8E84sVHJELSwIDAQAB
  -----END PUBLIC KEY-----`,privateKey:`-----BEGIN RSA PRIVATE KEY-----
  MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQC3I66tt+aZvesNGQy3NLkzXZYnqnCuy2UCctvoydidCHxOCpWjs/9pOj6+anSZk6UlYpKTZscSPOvtu2/f9QVjCQDB/AeWQfVa5fbiVLbFsDt/5Kxa3yqrvi0yg+2IaAJsUKdHdM/lonBYp+XzIa3PVV/n57Tcjd8nkrdR+PWX5UCj4MKOg8WPlL2o0Tt/oDnc7UBIQm9DuiU23JS50ye+5QzxIaEqQ6N1SohdIGd1DutUmwNL3WgPP4ukc846SQiW3rpjcKjhUxJlkzksce3raWcpgr2voNdjCMZDxIzkCeGpeUiYHVlIqxdMxyHTg/3c9HsaAVeFPwTzixUckQtLAgMBAAECggEAAneghwsLk6OrcssVGfzDx/spSxI51o2WzLclSJgW/Vqbsq7j9xBsPLBURDab8fcpCg+vaNiKaeazyQBaYtqHR9YSSS9TjNct7okSK1iTQYJqqaal0Ka9LhK459/2Iur2qWTEfU+aESMACJ5Oc9kFqoJX3xK9thxlMi4TMS90Y5T3eVj57fKNZAnXkRzmEwxO4qz5FqMO2XoBxF0kkxRA5dVsDS+noFq1kRAtITEsmpNOsB1ckdXGxTIwqh2BnD0YP4Hux7Y7ZMDZ4oHQtGj5jsboHf072m1VFJ/JOufkJwgMyUNQqHi0fob5ASvhwmP1gmv7xBnP7HsooF5ZLuWrkQKBgQDef2YiGuXccbRk5qzAKtTV4E4qLAvMfzEvsmibsypjEbVJxq9yaPzPtQN/AGCUZu/W2RpYHt2JjNe42rhAPjhIBEmCAV1koeP8bFIJkv9tCKocoxO4SQNxTs4dzHCW45KADWGqni2q47P+cuV7rIUabXCZ9uV26Tl62xY35s/0MQKBgQDStySekYHP7WisO+M7P48fRlQ5k2ZwaTPp/59g8rP1Ye+n5n9zPcXDRQBhFn6la4z0YiOLCdt4qgPf3wkR68oyM3hex41dWlk3lg5ySIrOVNRyQcfkrGAdYLWi/AEfoZiMyGdVTbp3N4lSwbmIVVgYkkTi6hy4KPkFG1ewYkMEOwKBgGmlOEuNVgNcAfm/Bdug+roq7TJdA6Uv55zsK3tykPfFWr0TGA9NBm1hV62f8jvEvLDZGQcqcKp1M6DUSZRHdtXLI1QVbdDwhZ4/mJxvLdUJviwmyqBAGuBcOMYxYmxi1hbzQ6KNxMVVpQt2ZrxYaELqIAMbFk1l5CMPj/cvIyKhAoGALNvQb/GKMTnZjtExDuv5DC9svtUiecvrwWUqCPmiVhsDajsn5uC/uVJ3QjQHwi+jUmOSLYdrscSADqjsxWPtJ8LNXWAeOEGDvNG1QZ8v7b0hfTGD3KrVy2tLP+dmVdWRJGeFmCN0Du1DztpvJRcGKjT5dVVhx9LxMKUhhetlWQECgYBY2pdSQGkknTGadfej8b0AtELrS9Zemm3gO68+i4/tAfqsls+9l1aV9KdyftHSivmMYamYp5rDbN+EAqesiGsGMXp6GOc0Dkq8a1R+dqYBz+esUvA0bee/fc2Gt6v4Uq1NhiTd+zct6F90gHEZDdCcE2oPMfRuMgAB4YIsJ8sC8Q==
  -----END RSA PRIVATE KEY-----`},o=new s.X,n={encrypt:function(e){return o.setPublicKey(i.publicKey),o.encrypt(e)},decrypt:function(e){return o.setPrivateKey(i.privateKey),JSON.parse(o.decrypt(e))}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,642],()=>r(39235));module.exports=s})();